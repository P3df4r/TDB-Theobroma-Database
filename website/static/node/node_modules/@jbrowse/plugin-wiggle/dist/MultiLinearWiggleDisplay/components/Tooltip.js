"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.Tooltip = void 0;
const react_1 = __importDefault(require("react"));
const mobx_react_1 = require("mobx-react");
// locals
const util_1 = require("../../util");
const Tooltip_1 = __importDefault(require("../../Tooltip"));
exports.Tooltip = Tooltip_1.default;
const en = (n) => n.toLocaleString('en-US');
const TooltipContents = react_1.default.forwardRef(({ model, feature }, ref) => {
    const start = feature.get('start');
    const end = feature.get('end');
    const refName = feature.get('refName');
    const coord = start === end ? en(start) : `${en(start)}..${en(end)}`;
    const sources = feature.get('sources');
    const source = feature.get('source');
    const summary = feature.get('summary');
    const obj = Object.fromEntries(model.sources.map(ent => [ent.name, ent]));
    return (react_1.default.createElement("div", { ref: ref },
        [refName, coord].filter(f => !!f).join(':'),
        react_1.default.createElement("br", null),
        sources ? (react_1.default.createElement("table", null,
            react_1.default.createElement("thead", null,
                react_1.default.createElement("tr", null,
                    react_1.default.createElement("th", null, "color"),
                    react_1.default.createElement("th", null, "source"),
                    react_1.default.createElement("th", null, "score"))),
            react_1.default.createElement("tbody", null, Object.entries(sources).map(([source, data]) => {
                var _a;
                return (react_1.default.createElement("tr", { key: source },
                    react_1.default.createElement("td", { style: { background: (_a = obj[source]) === null || _a === void 0 ? void 0 : _a.color } }, " "),
                    react_1.default.createElement("td", null, source),
                    react_1.default.createElement("td", null, (0, util_1.toP)(data.score))));
            })))) : (react_1.default.createElement("span", null,
            source,
            ' ',
            summary
                ? `min:${(0, util_1.toP)(feature.get('minScore'))} avg:${(0, util_1.toP)(feature.get('score'))} max:${(0, util_1.toP)(feature.get('maxScore'))}`
                : (0, util_1.toP)(feature.get('score'))))));
});
const WiggleTooltip = (0, mobx_react_1.observer)((props) => {
    return react_1.default.createElement(Tooltip_1.default, { useClientY: true, TooltipContents: TooltipContents, ...props });
});
exports.default = WiggleTooltip;
//# sourceMappingURL=Tooltip.js.map